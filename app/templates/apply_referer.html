{% extends "base.html" %}
{% block content %}

<h2 style="text-align:center;">Become a Verified Referrer</h2>

<form method="POST" action="{{ url_for('main.apply_referer') }}">

    <label>Full Name: </label>
    <input type="text" id="full-name" name="full_name" required><br><br>

    <label>WhatsApp Number: </label>
    <input type="text" name="whatsapp_number" placeholder="2348123456789" required><br><br>

    <label for="bank">Select Your Bank:</label>
<select name="bank" id="bank" required>
    <option value="">--Choose Bank--</option>
    {% for bank in banks %}
        <option value="{{ bank.id }}">{{ bank.name }}</option>
    {% endfor %}
</select><br><br>

    <label>Account Number: </label>
    <input type="text" id="account-number" name="account_number" maxlength="10" required><br><br>

    <input type="checkbox" id="same-name" />
    <label for="same-name">My account name is the same as my full name</label><br><br>

    <label>Account Name: </label>
    <input type="text" id="account-name" name="account_name" required><br><br>

    <button type="submit">Complete Registration</button>

</form>

<script>
// Autofill account name if checkbox is ticked
document.getElementById('same-name').addEventListener('change', function () {
    const accountNameField = document.getElementById('account-name');
    const fullName = document.getElementById('full-name').value.trim();

    if (this.checked) {
        accountNameField.value = fullName;
        accountNameField.readOnly = true;  // prevent editing
    } else {
        accountNameField.value = '';
        accountNameField.readOnly = false; // allow manual entry
    }
});

// Keep account name updated if full name changes and checkbox is ticked
document.getElementById('full-name').addEventListener('input', function () {
    const checkbox = document.getElementById('same-name');
    const accountNameField = document.getElementById('account-name');
    if (checkbox.checked) {
        accountNameField.value = this.value.trim();
    }
});
</script>

<!--
<script>
document.getElementById('account-number').addEventListener('input', function () {
    const bankCode = document.getElementById('bank-select').value;
    const accNumber = this.value;

    if (bankCode && accNumber.length === 10) {
        fetch('/verify_account', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                bank_code: bankCode,
                account_number: accNumber
            })
        })
        .then(res => res.json())
        .then(data => {
            if (data.account_name) {
                document.getElementById('account-name').value = data.account_name;
            } else {
                document.getElementById('account-name').value = 'Verification failed';
            }
        });
    }
});
</script>
-->
{% endblock %}
