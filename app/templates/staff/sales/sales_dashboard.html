{% extends "base.html" %}
{% block content %}

<style>
/* Dashboard wrapper */
.dashboard-wrapper {
  display: flex;
  flex-wrap: wrap;      /* wrap cards on smaller screens */
  gap: 20px;
  justify-content: flex-start;
}

/* Each card */
.dashboard-card {
  flex: 1 1 300px;       /* grow/shrink, min-width 300px */
  min-width: 280px;
  background: #fff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  box-sizing: border-box;
}

/* Tables inside cards */
.table-wrapper {
  width: 100%;
  overflow-x: auto;      /* scroll if table too wide */
}

.table {
  width: 100%;
  border-collapse: collapse;
  min-width: 400px;      /* ensures table doesn’t collapse too small */
}

.table th, .table td {
  border: 1px solid #ddd;
  padding: 10px;
  white-space: nowrap;   /* prevent breaking cells */
  text-align: left;
}

/* Buttons */
.btn {
  padding: 6px 12px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
.btn.small { padding: 4px 8px; font-size: 0.9em; }

/* Status */
.status.pending { color: orange; font-weight: bold; }
</style>



<h2>Sales Attendant Dashboard</h2>
<div class="dashboard-wrapper">

  <!-- Profile Card -->
  <div class="dashboard-card">
    <p><strong>Name:</strong> {{ staff.name }}</p>
    <p><strong>Staff ID:</strong> {{ staff.staff_id }}</p>
    <p><strong>Role:</strong> {{ staff.role }}</p>
    <a href="{{ url_for('main.staff_add_product') }}">
      <button class="btn">➕ Add Product</button>
    </a>
  </div>

  <!-- Products Card -->
  <div class="dashboard-card">
    <h3>Products</h3>
    <div class="table-wrapper">
      <table class="table">
        <tr>
          <th>Name</th>
          <th>Price</th>
          <th>Action</th>
        </tr>
        {% for p in products %}
        <tr>
          <td>{{ p.name }}</td>
          <td>₦{{ p.price }}</td>
          <td>
            <a href="{{ url_for('main.staff_edit_product', id=p.id) }}">
              <button class="btn small">Edit</button>
            </a>
          </td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

  <!-- Orders Card -->
  <div class="dashboard-card">
    <h3>Orders</h3>
    <div class="table-wrapper">
      <table class="table">
        <tr>
          <th>Reference</th>
          <th>Paid</th>
          <th>Shipped</th>
          <th>Action</th>
        </tr>
        {% for o in orders %}
        <tr>
          <td>{{ o.reference }}</td>
          <td>{{ 'Yes' if o.paid else 'No' }}</td>
          <td>{{ 'Yes' if o.delivered else 'No' }}</td>
          <td>
            {% if o.paid %}
            <form method="POST"
                  action="{{ url_for('main.staff_toggle_shipped', order_id=o.id) }}">
              <button class="btn small">
                {{ 'Unmark' if o.delivered else 'Mark Shipped' }}
              </button>
            </form>
            {% else %}
            <span class="status pending">Unpaid</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

</div>

{% endblock %}

